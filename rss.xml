<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Christ Wu&#39;s Blog</title>
  
  <subtitle>一点微小的博客</subtitle>
  <link href="/rss.xml" rel="self"/>
  
  <link href="https://christwu.github.io/"/>
  <updated>2018-05-19T12:27:20.803Z</updated>
  <id>https://christwu.github.io/</id>
  
  <author>
    <name>Christ Wu</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Web应用部署注意事项</title>
    <link href="https://christwu.github.io/2018/05/15/deployment/"/>
    <id>https://christwu.github.io/2018/05/15/deployment/</id>
    <published>2018-05-14T16:00:00.000Z</published>
    <updated>2018-05-19T12:27:20.803Z</updated>
    
    <content type="html"><![CDATA[<p>部署Web应用是一项细活：它的配置和操作通常涉及各方面，而且要求准确无误。平时注意配置管理，工作认真负责，方可保证应用正常上线运行。<br><a id="more"></a> </p><h1 id="部署之前"><a href="#部署之前" class="headerlink" title="部署之前"></a>部署之前</h1><h2 id="开发时"><a href="#开发时" class="headerlink" title="开发时"></a>开发时</h2><p>早在开发阶段就应当注意整理和维护应用配置，包括但不限于：</p><ol><li>各数据源的配置（地址、端口、实例、用户名、密码）与涉及的配置文件；</li><li>外部接口的地址（IP、端口、路径等）与涉及的配置文件；</li><li>依赖的外部程序（例如ImageMagick等）；</li><li>应用中开发模式/生产模式的切换开关（如果有的话）；</li><li>涉及文件操作的目录路径（如果需要在应用程序目录中读写文件的话）；</li><li>准确的数据库表结构（字段名、类型、长度、Nullable）、索引、序列（如使用Oracle等数据库）、触发器、存储过程、函数以及字典数据内容。在维护数据库时应注意同步数据库设计文档、开发库、测试库，系统部署时还要同步维护生产库。</li></ol><p>开发过程中，如无特殊需求，应避免将应用地址、端口或路径写死，否则的话，一旦需要更换地址或路径就会遇到很大的麻烦。</p><h2 id="上线前"><a href="#上线前" class="headerlink" title="上线前"></a>上线前</h2><p>准备部署之前，应完整识别出开发/测试环境与生产环境配置的差异，避免疏漏。除此之外，强烈建议对各服务器资源和部署步骤进行记录，例如：</p><ol><li>各服务器内网IP地址、公网IP地址、操作系统、CPU、内存、硬盘空间；</li><li>各服务器用途（数据库/应用节点/负载均衡等）；</li><li>各服务器主要应用及版本；</li><li>各服务器登录方式；</li><li>应用或数据部署路径；</li><li>系统设置，包括防火墙、参数设定等。</li></ol><p>操作生产环境之前，最好找个类似的测试环境进行测试，了解如何处理意外情况（例如断电、死机、系统慢等）。</p><p>如果预计需要频繁部署，建议写部署脚本。</p><h1 id="部署中"><a href="#部署中" class="headerlink" title="部署中"></a>部署中</h1><h2 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h2><p>部署数据库时应注意：</p><ol><li>确保数据库软件已正确安装和启动；</li><li>表空间、账号密码正确；</li><li>字符集配置正确；</li><li>正确建立表结构、索引、序列、触发器、存储过程、函数等；对于升级，正确将旧结构修改成新结构；</li><li>正确初始化字典数据；</li><li>根据实际情况调整连接数和 Max open files 等设置。</li></ol><h2 id="应用服务器"><a href="#应用服务器" class="headerlink" title="应用服务器"></a>应用服务器</h2><p>部署应用时需要注意：</p><ol><li>各软件（如Apache、PHP和应用所需外部程序）已正确安装，环境变量、端口、证书（HTTPS）正确配置；</li><li>程序代码或编译后文件已放到正确位置；</li><li>如果应用不是以root身份启动，那么程序文件已设置正确所有者；</li><li>应用程序配置、数据源已按生产环境进行修改；</li><li>系统防火墙和相关外部接口已正确配置；</li><li>如果系统规模较大，Max open files 数量（/etc/security/limits.conf）和 fs.file-max（/etc/sysctl.conf）已进行调整；</li><li>了解如何取用后台日志。</li></ol><h2 id="负载均衡"><a href="#负载均衡" class="headerlink" title="负载均衡"></a>负载均衡</h2><ol><li>注意各节点应配置好；</li><li>注意负载均衡算法的选择；</li><li>注意会话保持的设置。</li></ol><h1 id="部署之后"><a href="#部署之后" class="headerlink" title="部署之后"></a>部署之后</h1><p>部署时或部署完成后，仍然要对资源和使用情况进行整理总结，以便后续运维。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;部署Web应用是一项细活：它的配置和操作通常涉及各方面，而且要求准确无误。平时注意配置管理，工作认真负责，方可保证应用正常上线运行。&lt;br&gt;
    
    </summary>
    
      <category term="经验" scheme="https://christwu.github.io/categories/%E7%BB%8F%E9%AA%8C/"/>
    
    
      <category term="Web" scheme="https://christwu.github.io/tags/Web/"/>
    
  </entry>
  
</feed>
